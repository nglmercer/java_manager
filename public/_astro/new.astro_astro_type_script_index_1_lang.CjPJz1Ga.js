import{serverapi as s}from"./fetchapi.CXYT3pXQ.js";import"./select.C1wwNMsU.js";import"./lit-element.CdPzzhzS.js";import"./lit-html.Cs9YtZST.js";import"./property.a2FlD-39.js";import"./directive.CGE4aKEl.js";import"./map.DiiNQ3pp.js";function u(e){return Object.values(e).map(o=>({value:o.versionsMethod||o.urlGetMethod,label:o.displayName||o.name}))}const l=document.querySelector(".javaVersion");async function v(){try{const e=document.querySelector(".selectcore"),r=document.querySelector(".coreVersion");if(r.isLoading=!0,!e){console.warn("Elemento .selectcore no encontrado");return}const o=await s.getCores();if(console.log("getCores",o),!o||!o.data){console.error("No se pudieron obtener los cores");return}const t=u(o.data);console.log("result",o,t),e.isLoading=!1,e.options=t,e.addEventListener("change",async a=>{const c=a.detail;console.log("e",c);try{const n=await s.getCoreData(c.value);if(console.log("result",n),n&&n.data){const d=Array.isArray(n.data)?n.data:n.data.versions;await p(d,r)}}catch(n){console.error("Error al obtener las versiones del core:",n)}})}catch(e){console.error("Error en fetchCores:",e)}}async function f(){try{const e=await s.getVSJava();if(console.log("getVSJava",e),!e||!e.data){console.error("No se pudieron obtener las versiones de Java");return}await g(e.data)}catch(e){console.error("Error en fetchJavav:",e)}}async function p(e,r){try{const o=r||document.querySelector(".coreVersion");if(!o){console.warn("Elemento .coreVersion no encontrado");return}const t=i(e);console.log("optionsCore",t,o),o.isLoading=!1,o.options=t}catch(o){console.error("Error en setcoreversions:",o)}}async function g(e){try{if(!e||!e.available){console.error("Datos de versiones de Java invÃ¡lidos");return}if(!l){console.warn("Elemento .javaVersion no encontrado");return}const r=i(e.available,e.installed);console.log("setjavaversions",r,e),l.isLoading=!1,l.options=r}catch(r){console.error("Error en setjavaversions:",r)}}function i(e,r=[]){return e&&Array.isArray(e)&&r&&Array.isArray(r)?e.map(o=>{const t=r.some(a=>a===o);return{label:`${o}${t?" installed":""}`,name:`${o}${t?" installed":""}`,status:t?"installed":"not-installed",value:o}}):[]}async function m(){try{const e=await s.getTasks();if(!e||!e.data){console.error("No se pudieron obtener las tareas");return}const r=e.data;return console.log("result",e,r),r}catch(e){console.error("Error en fetchTasks:",e)}}document.addEventListener("DOMContentLoaded",()=>{v(),f(),m(),l?.addEventListener("install-version",async e=>{const r=e.detail,{version:o}=r;if(!o)return;const t=await s.findJavaVersion(o);if(!t||t.error){const a=await s.installJava(o);console.log("installJava",a)}else console.log("resultInstall",{detail:r,resultInstall:t})})});
