import{Z as d,T as y,B as b}from"../lit-html.Cs9YtZST.js";import{t as p}from"../directive.CGE4aKEl.js";import{i as v,e as w,l as g,f as A}from"../directive-helpers.CY_bUdrT.js";const $={resolveDirective:d.V,ElementPart:d.F,TemplateInstance:d.R,isIterable:d.D,ChildPart:d.I};/**
 * @license
 * Copyright 2019 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const{TemplateInstance:E,isIterable:P,resolveDirective:f,ChildPart:h,ElementPart:x}=$,T=(l,o,a={})=>{if(o._$litPart$!==void 0)throw Error("container already contains a live render");let i,t,r;const e=[],c=document.createTreeWalker(o,NodeFilter.SHOW_COMMENT);let n;for(;(n=c.nextNode())!==null;){const s=n.data;if(s.startsWith("lit-part")){if(e.length===0&&i!==void 0)throw Error(`There must be only one root part per container. Found a part marker (${n}) when we already have a root part marker (${t})`);r=I(l,n,e,a),i===void 0&&(i=r),t??=n}else if(s.startsWith("lit-node"))R(n,e,a);else if(s.startsWith("/lit-part")){if(e.length===1&&r!==i)throw Error("internal error");r=_(n,r,e)}}if(i===void 0){const s=o instanceof ShadowRoot?"{container.host.localName}'s shadow root":o instanceof DocumentFragment?"DocumentFragment":o.localName;console.error(`There should be exactly one root part in a render container, but we didn't find any in ${s}.`)}o._$litPart$=i},I=(l,o,a,i)=>{let t,r;if(a.length===0)r=new h(o,null,void 0,i),t=l;else{const e=a[a.length-1];if(e.type==="template-instance")r=new h(o,null,e.instance,i),e.instance._$AV.push(r),t=e.result.values[e.instancePartIndex++],e.templatePartIndex++;else if(e.type==="iterable"){r=new h(o,null,e.part,i);const c=e.iterator.next();if(c.done)throw t=void 0,e.done=!0,Error("Unhandled shorter than expected iterable");t=c.value,e.part._$AH.push(r)}else r=new h(o,null,e.part,i)}if(t=f(r,t),t===y)a.push({part:r,type:"leaf"});else if(v(t))a.push({part:r,type:"leaf"}),r._$AH=t;else if(w(t)){if(g(t))throw Error("compiled templates are not supported");const e="lit-part "+C(t);if(o.data!==e)throw Error("Hydration value mismatch: Unexpected TemplateResult rendered to part");{const c=h.prototype._$AC(t),n=new E(c,r);a.push({type:"template-instance",instance:n,part:r,templatePartIndex:0,instancePartIndex:0,result:t}),r._$AH=n}}else P(t)?(a.push({part:r,type:"iterable",value:t,iterator:t[Symbol.iterator](),done:!1}),r._$AH=[]):(a.push({part:r,type:"leaf"}),r._$AH=t??"");return r},_=(l,o,a)=>{if(o===void 0)throw Error("unbalanced part marker");o._$AB=l;const i=a.pop();if(i.type==="iterable"&&!i.iterator.next().done)throw Error("unexpected longer than expected iterable");if(a.length>0)return a[a.length-1].part},R=(l,o,a)=>{const i=/lit-node (\d+)/.exec(l.data),t=parseInt(i[1]),r=l.nextElementSibling;if(r===null)throw Error("could not find node for attribute parts");r.removeAttribute("defer-hydration");const e=o[o.length-1];if(e.type!=="template-instance")throw Error("Hydration value mismatch: Primitive found where TemplateResult expected. This usually occurs due to conditional rendering that resulted in a different value or template being rendered between the server and client.");{const c=e.instance;for(;;){const n=c._$AD.parts[e.templatePartIndex];if(n===void 0||n.type!==p.ATTRIBUTE&&n.type!==p.ELEMENT||n.index!==t)break;if(n.type===p.ATTRIBUTE){const s=new n.ctor(r,n.name,n.strings,e.instance,a),u=A(s)?e.result.values[e.instancePartIndex]:e.result.values,m=!(s.type===p.EVENT||s.type===p.PROPERTY);s._$AI(u,s,e.instancePartIndex,m),e.instancePartIndex+=n.strings.length-1,c._$AV.push(s)}else{const s=new x(r,e.instance,a);f(s,e.result.values[e.instancePartIndex++]),c._$AV.push(s)}e.templatePartIndex++}}},C=l=>{const o=new Uint32Array(2).fill(5381);for(const i of l.strings)for(let t=0;t<i.length;t++)o[t%2]=33*o[t%2]^i.charCodeAt(t);const a=String.fromCharCode(...new Uint8Array(o.buffer));return btoa(a)};globalThis.litElementHydrateSupport=({LitElement:l})=>{const o=Object.getOwnPropertyDescriptor(Object.getPrototypeOf(l),"observedAttributes").get;Object.defineProperty(l,"observedAttributes",{get(){return[...o.call(this),"defer-hydration"]}});const a=l.prototype.attributeChangedCallback;l.prototype.attributeChangedCallback=function(e,c,n){e==="defer-hydration"&&n===null&&i.call(this),a.call(this,e,c,n)};const i=l.prototype.connectedCallback;l.prototype.connectedCallback=function(){this.hasAttribute("defer-hydration")||i.call(this)};const t=l.prototype.createRenderRoot;l.prototype.createRenderRoot=function(){return this.shadowRoot?(this._$AG=!0,this.shadowRoot):t.call(this)};const r=Object.getPrototypeOf(l.prototype).update;l.prototype.update=function(e){const c=this.render();if(r.call(this,e),this._$AG){this._$AG=!1;for(let n=0;n<this.attributes.length;n++){const s=this.attributes[n];if(s.name.startsWith("hydrate-internals-")){const u=s.name.slice(18);this.removeAttribute(u),this.removeAttribute(s.name)}}T(c,this.renderRoot,this.renderOptions)}else b(c,this.renderRoot,this.renderOptions)}};
